import { useEffect } from 'react';
import { MusicVAE, INoteSequence, sequences } from '@magenta/music/es6';
import { toMidi } from './utils/midiHelpers';

const MidiConvert = () => {
  useEffect(() => {
    const vae = new MusicVAE('https://storage.googleapis.com/magentadata/js/checkpoints/music_vae/mel_16bar_small_q2');

    const SAD: INoteSequence = {
      ticksPerQuarter: 480,
      timeSignatures: [{ time: 0, numerator: 4, denominator: 4 }],
      tempos: [{ time: 0, qpm: 120 }],
      notes: [
        {
          pitch: 64,
          velocity: 74,
          startTime: 0,
          endTime: 0.24583333333333332,
          instrument: 0,
          program: 0,
          isDrum: false,
        },
        {
          pitch: 71,
          velocity: 87,
          startTime: 0.25,
          endTime: 0.4947916666666667,
          instrument: 0,
          program: 0,
          isDrum: false,
        },
        {
          pitch: 71,
          velocity: 101,
          startTime: 0.5,
          endTime: 0.7458333333333333,
          instrument: 0,
          program: 0,
          isDrum: false,
        },
        {
          pitch: 69,
          velocity: 97,
          startTime: 0.75,
          endTime: 0.9958333333333333,
          instrument: 0,
          program: 0,
          isDrum: false,
        },
        {
          pitch: 71,
          velocity: 101,
          startTime: 1,
          endTime: 1.2458333333333333,
          instrument: 0,
          program: 0,
          isDrum: false,
        },
        {
          pitch: 60,
          velocity: 91,
          startTime: 1.25,
          endTime: 1.4958333333333333,
          instrument: 0,
          program: 0,
          isDrum: false,
        },
        {
          pitch: 64,
          velocity: 83,
          startTime: 1.5,
          endTime: 1.7458333333333333,
          instrument: 0,
          program: 0,
          isDrum: false,
        },
        { pitch: 71, velocity: 99, startTime: 1.75, endTime: 2, instrument: 0, program: 0, isDrum: false },
        { pitch: 64, velocity: 74, startTime: 2, endTime: 2.245833333333333, instrument: 0, program: 0, isDrum: false },
        {
          pitch: 71,
          velocity: 87,
          startTime: 2.25,
          endTime: 2.4947916666666665,
          instrument: 0,
          program: 0,
          isDrum: false,
        },
        {
          pitch: 71,
          velocity: 101,
          startTime: 2.5,
          endTime: 2.745833333333333,
          instrument: 0,
          program: 0,
          isDrum: false,
        },
        {
          pitch: 69,
          velocity: 97,
          startTime: 2.75,
          endTime: 2.995833333333333,
          instrument: 0,
          program: 0,
          isDrum: false,
        },
        {
          pitch: 71,
          velocity: 101,
          startTime: 3,
          endTime: 3.245833333333333,
          instrument: 0,
          program: 0,
          isDrum: false,
        },
        {
          pitch: 64,
          velocity: 83,
          startTime: 3.25,
          endTime: 3.495833333333333,
          instrument: 0,
          program: 0,
          isDrum: false,
        },
        { pitch: 71, velocity: 99, startTime: 3.5, endTime: 3.75, instrument: 0, program: 0, isDrum: false },
        { pitch: 64, velocity: 99, startTime: 3.75, endTime: 4, instrument: 0, program: 0, isDrum: false },
        { pitch: 84, velocity: 99, startTime: 4, endTime: 4.25, instrument: 0, program: 0, isDrum: false },
        { pitch: 83, velocity: 99, startTime: 4.25, endTime: 4.5, instrument: 0, program: 0, isDrum: false },
        { pitch: 64, velocity: 99, startTime: 4.5, endTime: 4.75, instrument: 0, program: 0, isDrum: false },
        { pitch: 76, velocity: 99, startTime: 4.75, endTime: 5, instrument: 0, program: 0, isDrum: false },
        { pitch: 74, velocity: 99, startTime: 5, endTime: 5.25, instrument: 0, program: 0, isDrum: false },
        { pitch: 64, velocity: 99, startTime: 5.25, endTime: 5.5, instrument: 0, program: 0, isDrum: false },
        { pitch: 72, velocity: 99, startTime: 5.5, endTime: 5.75, instrument: 0, program: 0, isDrum: false },
        { pitch: 71, velocity: 99, startTime: 5.75, endTime: 6, instrument: 0, program: 0, isDrum: false },
        { pitch: 72, velocity: 99, startTime: 6, endTime: 6.25, instrument: 0, program: 0, isDrum: false },
        { pitch: 71, velocity: 99, startTime: 6.25, endTime: 6.5, instrument: 0, program: 0, isDrum: false },
        { pitch: 74, velocity: 99, startTime: 6.5, endTime: 6.75, instrument: 0, program: 0, isDrum: false },
        { pitch: 72, velocity: 99, startTime: 6.75, endTime: 7, instrument: 0, program: 0, isDrum: false },
        { pitch: 74, velocity: 99, startTime: 7, endTime: 7.25, instrument: 0, program: 0, isDrum: false },
        { pitch: 72, velocity: 99, startTime: 7.25, endTime: 7.5, instrument: 0, program: 0, isDrum: false },
        { pitch: 76, velocity: 99, startTime: 7.5, endTime: 7.75, instrument: 0, program: 0, isDrum: false },
        { pitch: 74, velocity: 99, startTime: 7.75, endTime: 8, instrument: 0, program: 0, isDrum: false },
        { pitch: 76, velocity: 99, startTime: 8, endTime: 8.25, instrument: 0, program: 0, isDrum: false },
        { pitch: 74, velocity: 99, startTime: 8.25, endTime: 8.5, instrument: 0, program: 0, isDrum: false },
        { pitch: 77, velocity: 99, startTime: 8.5, endTime: 8.75, instrument: 0, program: 0, isDrum: false },
        { pitch: 76, velocity: 99, startTime: 8.75, endTime: 9, instrument: 0, program: 0, isDrum: false },
        { pitch: 77, velocity: 99, startTime: 9, endTime: 9.25, instrument: 0, program: 0, isDrum: false },
        { pitch: 76, velocity: 99, startTime: 9.25, endTime: 9.5, instrument: 0, program: 0, isDrum: false },
      ],
      totalTime: 9.5,
      quantizationInfo: { stepsPerQuarter: 4 },
    };

    const HAPPY: INoteSequence = {
      ticksPerQuarter: 480,
      timeSignatures: [{ time: 0, numerator: 4, denominator: 4 }],
      notes: [
        {
          pitch: 64,
          velocity: 83,
          startTime: 4.219791666666667,
          endTime: 4.465625,
          instrument: 0,
          program: 0,
          isDrum: false,
        },
        {
          pitch: 67,
          velocity: 89,
          startTime: 4.469791666666667,
          endTime: 4.715625,
          instrument: 0,
          program: 0,
          isDrum: false,
        },
        {
          pitch: 71,
          velocity: 99,
          startTime: 4.719791666666667,
          endTime: 5.965625,
          instrument: 0,
          program: 0,
          isDrum: false,
        },
        {
          pitch: 60,
          velocity: 103,
          startTime: 5.969791666666667,
          endTime: 6.215625,
          instrument: 0,
          program: 0,
          isDrum: false,
        },
        {
          pitch: 64,
          velocity: 80,
          startTime: 6.219791666666667,
          endTime: 6.465625,
          instrument: 0,
          program: 0,
          isDrum: false,
        },
        {
          pitch: 67,
          velocity: 96,
          startTime: 6.469791666666667,
          endTime: 6.715625,
          instrument: 0,
          program: 0,
          isDrum: false,
        },
        {
          pitch: 71,
          velocity: 85,
          startTime: 6.719791666666667,
          endTime: 6.965625,
          instrument: 0,
          program: 0,
          isDrum: false,
        },
        {
          pitch: 72,
          velocity: 83,
          startTime: 6.969791666666667,
          endTime: 7.215625,
          instrument: 0,
          program: 0,
          isDrum: false,
        },
        {
          pitch: 71,
          velocity: 97,
          startTime: 7.219791666666667,
          endTime: 7.469791666666667,
          instrument: 0,
          program: 0,
          isDrum: false,
        },
        {
          pitch: 69,
          velocity: 99,
          startTime: 7.469791666666667,
          endTime: 7.715625,
          instrument: 0,
          program: 0,
          isDrum: false,
        },
        {
          pitch: 71,
          velocity: 97,
          startTime: 7.719791666666667,
          endTime: 7.965625,
          instrument: 0,
          program: 0,
          isDrum: false,
        },
        {
          pitch: 60,
          velocity: 99,
          startTime: 7.969791666666667,
          endTime: 8.215625,
          instrument: 0,
          program: 0,
          isDrum: false,
        },
        {
          pitch: 64,
          velocity: 95,
          startTime: 8.219791666666667,
          endTime: 8.465625,
          instrument: 0,
          program: 0,
          isDrum: false,
        },
        {
          pitch: 67,
          velocity: 90,
          startTime: 8.469791666666667,
          endTime: 8.690625,
          instrument: 0,
          program: 0,
          isDrum: false,
        },
        {
          pitch: 69,
          velocity: 107,
          startTime: 8.719791666666667,
          endTime: 9.969791666666667,
          instrument: 0,
          program: 0,
          isDrum: false,
        },
        {
          pitch: 62,
          velocity: 97,
          startTime: 9.969791666666667,
          endTime: 10.215625,
          instrument: 0,
          program: 0,
          isDrum: false,
        },
        {
          pitch: 66,
          velocity: 63,
          startTime: 10.219791666666667,
          endTime: 10.465625,
          instrument: 0,
          program: 0,
          isDrum: false,
        },
        {
          pitch: 69,
          velocity: 80,
          startTime: 10.469791666666667,
          endTime: 10.711458333333333,
          instrument: 0,
          program: 0,
          isDrum: false,
        },
        {
          pitch: 71,
          velocity: 52,
          startTime: 10.719791666666667,
          endTime: 10.965625,
          instrument: 0,
          program: 0,
          isDrum: false,
        },
        {
          pitch: 72,
          velocity: 111,
          startTime: 10.969791666666667,
          endTime: 11.215625,
          instrument: 0,
          program: 0,
          isDrum: false,
        },
        {
          pitch: 71,
          velocity: 82,
          startTime: 11.219791666666667,
          endTime: 11.451041666666667,
          instrument: 0,
          program: 0,
          isDrum: false,
        },
        {
          pitch: 69,
          velocity: 76,
          startTime: 11.469791666666667,
          endTime: 11.715625,
          instrument: 0,
          program: 0,
          isDrum: false,
        },
        {
          pitch: 71,
          velocity: 98,
          startTime: 11.719791666666667,
          endTime: 11.965625,
          instrument: 0,
          program: 0,
          isDrum: false,
        },
        {
          pitch: 62,
          velocity: 91,
          startTime: 11.969791666666667,
          endTime: 12.215625,
          instrument: 0,
          program: 0,
          isDrum: false,
        },
        {
          pitch: 66,
          velocity: 78,
          startTime: 12.219791666666667,
          endTime: 12.465625,
          instrument: 0,
          program: 0,
          isDrum: false,
        },
        {
          pitch: 69,
          velocity: 71,
          startTime: 12.469791666666667,
          endTime: 12.715625,
          instrument: 0,
          program: 0,
          isDrum: false,
        },
        {
          pitch: 71,
          velocity: 102,
          startTime: 12.719791666666667,
          endTime: 13.965625,
          instrument: 0,
          program: 0,
          isDrum: false,
        },
        {
          pitch: 60,
          velocity: 93,
          startTime: 13.969791666666667,
          endTime: 14.215625,
          instrument: 0,
          program: 0,
          isDrum: false,
        },
        {
          pitch: 64,
          velocity: 87,
          startTime: 14.219791666666667,
          endTime: 14.465625,
          instrument: 0,
          program: 0,
          isDrum: false,
        },
        {
          pitch: 67,
          velocity: 79,
          startTime: 14.469791666666667,
          endTime: 14.715625,
          instrument: 0,
          program: 0,
          isDrum: false,
        },
        {
          pitch: 71,
          velocity: 75,
          startTime: 14.719791666666667,
          endTime: 14.948958333333334,
          instrument: 0,
          program: 0,
          isDrum: false,
        },
        {
          pitch: 72,
          velocity: 91,
          startTime: 14.969791666666667,
          endTime: 15.215625,
          instrument: 0,
          program: 0,
          isDrum: false,
        },
        {
          pitch: 71,
          velocity: 98,
          startTime: 15.219791666666667,
          endTime: 15.465625,
          instrument: 0,
          program: 0,
          isDrum: false,
        },
        {
          pitch: 69,
          velocity: 100,
          startTime: 15.469791666666667,
          endTime: 15.715625,
          instrument: 0,
          program: 0,
          isDrum: false,
        },
        {
          pitch: 71,
          velocity: 94,
          startTime: 15.719791666666667,
          endTime: 15.965625,
          instrument: 0,
          program: 0,
          isDrum: false,
        },
        {
          pitch: 69,
          velocity: 53,
          startTime: 15.969791666666667,
          endTime: 16.215625,
          instrument: 0,
          program: 0,
          isDrum: false,
        },
        {
          pitch: 67,
          velocity: 68,
          startTime: 16.219791666666666,
          endTime: 16.465625,
          instrument: 0,
          program: 0,
          isDrum: false,
        },
        {
          pitch: 66,
          velocity: 82,
          startTime: 16.469791666666666,
          endTime: 16.715625,
          instrument: 0,
          program: 0,
          isDrum: false,
        },
        {
          pitch: 64,
          velocity: 82,
          startTime: 16.719791666666666,
          endTime: 17.969791666666666,
          instrument: 0,
          program: 0,
          isDrum: false,
        },
      ],
      quantizationInfo: { stepsPerQuarter: 4 },
    };

    const quantizedHappy = sequences.quantizeNoteSequence(HAPPY, 4);
    const quantizedSad = sequences.quantizeNoteSequence(SAD, 4);

    vae.initialize().then(() => {
      vae.interpolate([quantizedSad, quantizedHappy], 3).then((melodies) => {
        console.log(JSON.stringify(melodies));
      });
    });
  }, []);

  return <div>Check the console!</div>;
};

export default MidiConvert;
